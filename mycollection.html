<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,viewport-fit=cover, initial-scale=1.0, maximum-scale=1.0,user-scalable=0" />
	<meta name="applicable-device" content="pc,mobile"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="apple-touch-fullscreen" content="yes"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
	<meta name="format-detection" content="telephone=no"/>
	<meta http-equiv="X-UA-Compatible" content="edge">
	<meta name="x5-fullscreen" content="true">
	<meta name="full-screen" content="yes">
	<meta name="wap-font-scale" content="no">
	<script src="js/flexible.js"></script>
	<title>智慧居家养老平台</title>
	<link rel="apple-touch-icon" type="image/jpg" href="">
	<link rel="icon" type="image/jpg" href="">
    <link rel="stylesheet" href="css/iconfont.css" />
	<link rel="stylesheet" href="css/base.css" />

</head>
<body>
	<div class="container croll">
		<header class="headerUser">
			<div class="hederHomeBanner">
				<a href="javascript:history.go(-1)" class="iconfont headIconPic">&#xe65f;</a>    			
    			<h2>我的收藏</h2>
				<div class="collectrig_shai">编辑</div>
    		</div>
		</header>
		<div class="collectcart">
			<div class="Cartcollect-item">					
				<div class="Cartcollect-item-contain">						
					<div class="CartOrdercollect">
						<div class="collection">
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img12.360buyimg.com/n2/s270x270_jfs/t1/222615/37/4792/422959/61ab2cd0Ea63ae74f/66febe2cbec2d061.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">美盾阿胶红枣蛋白粉营养健康蛋白质粉中老年人养生固体饮料营养粉 320g/罐</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;168.00</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img12.360buyimg.com/n2/s270x270_jfs/t1/188959/35/21916/150920/62441b88E5a6627bc/4e0f058ac1efe8a1.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">张奶奶100%活海刺参肽粉精华肽冲饮小分子专利技术无添加多种蛋白 实惠装 老少皆宜滋补营养健康易吸收 实惠装90g 【3g*10袋*3盒】</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;1190.00</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img14.360buyimg.com/n2/s270x270_jfs/t1/220810/21/15967/298682/62410d41E9a88fc73/2c46e7c435bea914.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">福东海 新会老陈皮100g 典藏礼罐装 约十五年 新会源产陈皮干 大红皮 茶叶花草茶泡水 精选老皮 送礼佳品</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;98.00</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>		
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img10.360buyimg.com/n2/s240x240_jfs/t1/197570/20/17364/90553/6194b9b8Ef021c25f/3fe85d245b930780.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">ober康复机器人手套手部训练器材中风偏瘫气动锻炼手</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;1180.00</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>		
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img12.360buyimg.com/n2/s270x270_jfs/t1/150576/11/21157/207297/623eb54bEdede9b71/4e6aed6482781a81.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">中量肘关节康复训练器手臂屈伸牵引器胳膊骨折支架上肢脱臼术后锻炼中风偏瘫 肘关节康复器</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;1189.00</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>		
							<div class="collect-group-item">
								<div class="collect-info">	
									<div class="collect-check-box">
										<label class="collect-checkbox">
							                <input type="checkbox" name="cartcheck" class="check goods-check goodscollectCheck">
							                <i class="icon-collect-checkbox"></i>
										</label>	
									</div>
									<div class="collect-info-text clearfix">											
										<div class="collect-info-img"><a href="productdetail.html"><img src="https://img12.360buyimg.com/n2/s270x270_jfs/t1/222615/37/4792/422959/61ab2cd0Ea63ae74f/66febe2cbec2d061.jpg" /></a></div>
										<div class="collectitem flex">
											<div class="collect-message">
												<a href="productdetail.html" class="collect-message-name">美盾阿胶红枣蛋白粉营养健康蛋白质粉中老年人养生固体饮料营养粉 320g/罐</a>
											</div>
											<div class="mui-mark"><span class="mark-zt">满200减10</span></div>
											<div class="collect-counts">
												<div class="collect-pices clearfix">
													<b class="price fr">&yen;75.01</b>
													<a href="javascript:Tocart()" class="iconfont mui-cart">&#xe624;</a>
												</div>
											</div>
											<input type="hidden" class="collectTotal" value="0.00" />
										</div>
									</div>	
								</div>
							</div>		
									
						</div>
						
						<div class="center" id="emptyimg">
							<img class="emptyimg" src="static/images/bottom.png" />
						</div>
							
						<div class="payment-bar mui-fixed collectbottom" id="collectbottom">
							
							<div class="payment-r-box box">
								<div class="all-collect-checkbox">
									<label class="collect-checkbox">
									    <input type="checkbox" class="AllcollectCheck check goods-check goodscollectCheck">
									    <i class="icon-collect-checkbox"></i>
									    <span>全选</span>
									</label>	
								</div>
								<input class="collectTotalNum" type="hidden" />
								<a class="addgoCart">加入购物车</a>
								<a class="collect-delete-settle">取消关注</a>
							</div>
						</div>
					
					</div>
				</div>
			</div>	
			
		</div>
		
		
		
		<!--返回顶部-->
	  	<a class="totop iconfont">&#xe60e;</a>	
	</div>
	
	<script type="text/javascript" src="js/jquery-3.1.1.min.js" ></script>
	<script type="text/javascript" src="js/layer_mobile/layer.js"></script>
	<script type="text/javascript" src="js/common.js" ></script>

	<script>
		
		$(".collectrig_shai").click(function() {
		    if ($(this).html() == "编辑") {
		        $(this).html("完成");
		        $(".collect-delete-settle").css('display','flex');
		        $(".addgoCart").css('display','flex');
		        $(".collect-check-box").css('display','flex');
		        $("#collectbottom").show();
		    } else {
		        $(this).html("编辑");
		        $(".collect-delete-settle").hide();
		        $(".addgoCart").hide();
		        $(".collect-check-box").hide();
		        $("#collectbottom").hide();
		    }
		})
		

		$(function(){
			if($('.collectnum').val()<=1){
				$(this).val(1);
				$('.collectminus').attr('disabled',true);
			}
		})
			
		// 数量减
		$(".collectminus").click(function() {
			var s = $(this).parent().parent().find('.collectnum');
			s.val(parseInt(s.val()) - 1);
			if (s.val() <= 1 ) {
				s.val(1);
				$(this).attr('disabled',true);
			}
			loading();
			TotalCollect();
		});
			
		// 数量加
		$(".collectplus").click(function() {
			var s = $(this).parent().parent().find('.collectnum');
			$obj = $(this).parents('.collect-arithmetic').find('.collectminus'),
			s.val(parseInt(s.val()) + 1);
			if (s.val() <= 1) {
				s.val(1);
			}
			if(s.val() >1){
				$obj.attr('disabled',false);
			}
				
			loading();
			TotalCollect();
		});
			
		//购物车为空
					
		EmptyCollection=function(){
			var empty='';
			empty+='<div class="EmptyCollectionContent clearfix">'
				+	'<div class="EmptyCollectionTop">'
				+		'<i class="iconfont EmptyCollections">'+a+'</i>'
				+	'</div>'
				+	'<div class="EmptyCollectionBottom">'
				+		'<p>收藏夹还是空空的呢，快去看看吧~~</p>'
				+		'<p><a href="index.html" class="ToIndexBtn">去逛逛</a></p>'
				+	'</div>'
				+'</div>'
			$('.collectcart').append(empty);
					
		}
		a='&#xe6f2;'
		
		//全选和全不选
			        
		$('.AllcollectCheck').bind('click',function(){
			if(this.checked){    //全选
			    $("input[name='cartcheck']").each(function(){
			        $(this).prop('checked',true);
			    })
			    TotalCollect();
			}else{    //全不选
			    $("input[name='cartcheck']").each(function(){
			        $(this).prop('checked',false);
			    })
			    TotalCollect();
			}
			loading();
		});
	        
		//所有的子项选中或者不全选中后，全选按钮也选中或者不选中
		$(".CartOrdercollect input[type='checkbox']").change(function(){
			var allLength=$("input[name='cartcheck']").length; //所有的checkbox的长度
			$("input[name='cartcheck']").each(function(){
				$(this).bind('click',function(){
				    var selectedLength=$("input[name='cartcheck']:checked").length;//所有的选中的checkbox的长度
				    if(selectedLength==allLength){
				        $('.AllcollectCheck').prop("checked",true);//全选按钮
				    }else{
				        $('.AllcollectCheck').prop("checked",false);
				    }
				    TotalCollect();
				    loading();
				})
			})
			TotalCollect();
		})
		
		
		//计算
		function TotalCollect() {
			var allnum = 0;
			$(".collect-group-item").each(function() { 
				var nums=0;
				$(this).find(".goodscollectCheck").each(function() { 
					if ($(this).is(":checked")) { 
						var num = parseInt($(this).parents(".collect-info").find(".collectnum").val()); //数量
						nums+=num;
					}
					$(this).closest(".collect-group-item").find(".collectnum").text(nums);
				});
						      
				var onenum = parseFloat($(this).find(".collectnum").text()); 
				allnum += onenum;//已选商品总数量
		
			});
 
			if(allnum!=0){
				$(".collectTotalNum").text(allnum);
				$(".collectTotalNum").show();
			}else{
				$(".collectTotalNum").hide();
			}
			
		}
		
		//购物车为空
		function Collecthide(){
			if($(".collection").children().hasClass('collect-group-item')==false){
				$(".Cartcollect-item").remove();
				$(".reminder").hide();// 购物车为空时不显示温馨提示
				EmptyCollection();
			}
		}
		
		//点击批量取消
					
		$(".collect-delete-settle").click(function(){
			var $collectTotalNum=$(".collectTotalNum").text();
			ModalHelper.afterOpen();
			if($("input:checkbox[name='cartcheck']:checked").length == 0){
				layer.open({
		        	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe614;</i><span style="vertical-align: middle;">请选择要取消收藏的商品</span>',
		        	style:'font-size:0.28rem;',
		        	skin: 'msg',
		        	time: 1, //2秒后自动关闭
		        	end:function(){//层销毁
				    	ModalHelper.beforeClose();
				    }
		        });
				
			}else{
				layer.open({
					shadeClose: false, //禁止遮罩关闭
					content:'<i class="iconfont" style="vertical-align: middle;font-size:1rem;color: #2C6BFF;">&#xe636;</i><p style="font-size: 0.28rem;text-align: center;"> 是否确认将已选中的商品取消收藏？</p>',
					btn:['确认','取消'],
					no:function(){//取消
						ModalHelper.beforeClose();
					},
					yes: function(index, layero){//确认
						ModalHelper.beforeClose();
		                layer.close(index); //如果设定了yes回调，需进行手工关闭
		                
		                $("input[name='cartcheck']:checked").each(function(){
							var n=$(this).parent().parent().parent().parent().index();
							$(".collection").find(".collect-group-item:eq("+n+")").remove();
							layer.open({
			                	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe640;</i><span style="vertical-align: middle;">取消收藏成功!</span>',
			                	style:'font-size:0.28rem;',
			                	skin: 'msg',
			                	time: 2 //2秒后自动关闭
			                });
							TotalCollect();
							Collecthide();
						})		                
					}
				})
			}	

		})	
		
		
		//点击批量加入购物车
					
		$(".addgoCart").click(function(){
			var $collectTotalNum=$(".collectTotalNum").text();
			ModalHelper.afterOpen();
			if($("input:checkbox[name='cartcheck']:checked").length == 0){
				layer.open({
		        	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe614;</i><span style="vertical-align: middle;">请选择要加入购物车的商品</span>',
		        	style:'font-size:0.28rem;',
		        	skin: 'msg',
		        	time: 1, //2秒后自动关闭
		        	end:function(){//层销毁
				    	ModalHelper.beforeClose();
				    }
		        });
				
			}else{
				layer.open({
					shadeClose: false, //禁止遮罩关闭
					content:'<i class="iconfont" style="vertical-align: middle;font-size:1rem;color: #2C6BFF;">&#xe636;</i><p style="font-size: 0.28rem;text-align: center;"> 是否确认将已选中的商品加入购物车？</p>',
					btn:['确认','取消'],
					no:function(){//取消
						ModalHelper.beforeClose();
					},
					yes: function(index, layero){//确认
						ModalHelper.beforeClose();
		                layer.close(index); //如果设定了yes回调，需进行手工关闭
		                
		                $("input[name='cartcheck']:checked").each(function(){
							layer.open({
			                	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe640;</i><span style="vertical-align: middle;">加入购物车成功!</span>',
			                	style:'font-size:0.28rem;',
			                	skin: 'msg',
			                	time: 2 //2秒后自动关闭
			               });
						})		                
					}
				})
			}	

		})
		
		//加入购物车
		function Tocart(){
	    	layer.open({
	        	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe640;</i><span style="vertical-align: middle;">加入购物车成功!</span>',
	        	style:'font-size:0.28rem;',
	        	skin: 'msg',
	        	time: 2 //2秒后自动关闭
	        });
	    }
		
		$(function(){
			//超过一屏显示没有更多图片
			function emptyimgbottom(){
				if($(window).height()>document.body.clientHeight){
					$("#emptyimg").css({'display':'-webkit-box'});
				}
			}
			emptyimgbottom()
			
		})
	</script>
</body>
</html>