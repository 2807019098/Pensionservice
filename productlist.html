<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,viewport-fit=cover, initial-scale=1.0, maximum-scale=1.0,user-scalable=0" />
	<meta name="applicable-device" content="pc,mobile"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="apple-touch-fullscreen" content="yes"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
	<meta name="format-detection" content="telephone=no"/>
	<meta http-equiv="X-UA-Compatible" content="edge">
	<meta name="x5-fullscreen" content="true">
	<meta name="full-screen" content="yes">
	<meta name="wap-font-scale" content="no">
	<script src="static/js/flexible.js"></script>
	<title>智慧居家养老平台</title>
	<link rel="apple-touch-icon" type="image/jpg" href="">
	<link rel="icon" type="image/jpg" href="">
	<link rel="stylesheet" href="static/css/iconfont.css" />
	<link rel="stylesheet" href="static/css/shop.css" />

</head>
<body>
	<div class="container">
		<div class="search_head" id="search_head">
			<div class="search_head_fixer" id="search_head_fixer">
				<!--顶部-->
				<header class="center headTop" id="headTop">
					<a class="back iconfont" href="javascript:history.go(-1)">&#xe64f;</a>	
					<!--搜索-->
					<div class="muslist-search searchfix">			
						<div class="mui-input" id="searchinfo">
							<input type="text" data-url = "" class="mui-SearchInput" name="" placeholder="请搜索麦德龙商品" onfocus="this.placeholder=''" onblur="this.placeholder='请搜索麦德龙商品'"/>
							<input type="button" data-url = "" class="iconfont icon-search mui-SearchBtn middle" />
						</div>
					</div>
					<div class="mui-nav" id="mui-nav">
						<span></span>
					</div>
					<!--顶部导航-->
					<div class="navbox" style="display: none;">
						<ul>
							<li data-url = "index.html"><i class="iconfont">&#xe627;</i><span>首页</span></li>
							<li data-url = "category.html"><i class="iconfont">&#xe628;</i><span>分类</span></li>
							<li data-url = "shopcart.html"><i class="iconfont">&#xe624;</i><span>购物车</span></li>
							<li data-url = "myhome.html"><i class="iconfont">&#xe626;</i><span>我的</span></li>
						</ul>
					</div>
				</header>	
				<!--排序-->
				<div class="list-sorting" id="list-sorting">
					<ul class="list-ul box" id="list-ul">
						<li class="list-li flex">
							<a class="list-tab selecton" href="javascript:void(0)">综合</a>
						</li>
						<li class="list-li flex">
							<a class="list-tab" href="javascript:void(0)" id="listprice">价格<img src="static/images/list_default.png"></a>
						</li>
						<li class="list-li flex">
							<a class="list-tab" href="javascript:void(0)">销量</a>
						</li>
						<li class="list-li flex">
							<a class="list-tab" href="javascript:void(0)" id="listscreen">筛选<i class="iconfont iconscreen">&#xe77e;</i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		
		<!--搜索弹窗-->
		<div class="searchlist" id="searchlist">
			<header class="center headTop" id="searchheadTop">
				<a class="back iconfont" id="closesearch">&#xe64f;</a>	
				<!--搜索-->
				<div class="muslistbox-search searchfix">	
					<form method="get" action="productlist.html" id="searchform" autocomplete="off">
						<div class="mui-input">
							<input type="search" autocomplete="off" id="idNumber" class="mui-SearchInput" name="" placeholder="请搜索麦德龙商品" onfocus="this.placeholder=''" onblur="this.placeholder='请搜索麦德龙商品'">
							<input type="button" id="search1" class="iconfont icon-search mui-SearchBtn middle" />
						</div>
					</form>
				</div>
			</header>	
			<!--搜索关键词弹窗-->
			<div class="searchkey-box" id="keyBox">
				<ul></ul>
			</div>
		</div>
		
		
		<!--筛选弹窗-->
		<aside class="ui-aside">
			 <form autocomplete="off" method="" action="">
				<div class="screencontain">
					<dl class="mod-list">
						<dt class="sortcate layout-middle" id="option">
							<span class="flex">分类</span>
							<span class="keycate" id="keysort"></span>
							<i class="iconfont middle enter">&#xe613;</i>
						</dt>
					</dl>
					<dl class="mod-list">
						<dt class="dtbotbor">
							<span>价格区间</span>
						</dt>
						<dd class="regionprice" id="price_value">
							<input type="number" id="min_value" class="filterprice" placeholder="最低价" onfocus="this.placeholder=''" onblur="this.placeholder='最低价'">
							<div class="filterline"></div>
							<input type="number" id="max_value" class="filterprice" placeholder="最高价" onfocus="this.placeholder=''" onblur="this.placeholder='最高价'">
						</dd>
					</dl>
					<dl class="mod-list">
						<dt class="dtbotbor layout-middle" id="brandlist">
							<span class="flex brandWidth">品牌</span>
							<div class="key" id="keybrandbox"><span id="keybrand"></span></div>
							<span id="keycounts"></span>
						</dt>
						<dd>					
							<div class="brandbox clearfix brandcontent">
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="荟食(FINE LIFE)" name="check">
										<i class="icon-check">荟食(FINE LIFE)</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="五芳斋" name="check">
										<i class="icon-check">五芳斋</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="METRO Chef" name="check">
										<i class="icon-check">METRO Chef</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="宜客(AKA)" name="check">
										<i class="icon-check">宜客(AKA)</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="梅香" name="check">
										<i class="icon-check">梅香</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="百钻" name="check">
										<i class="icon-check">百钻</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="金龙鱼" name="check">
										<i class="icon-check">金龙鱼</i>
									</label>
								</div>
								<div class="list-btn">
									<label class="li-checkbox brandval">
										<input type="checkbox" value="福临门" name="check">
										<i class="icon-check">福临门</i>
									</label>
								</div>
								<div class="list-btn">
									<button class="lookall iconfont" id="lookall" type="button">查看更多</button>
								</div>
							</div>
							
						</dd>
					</dl>
										
				</div>		
				<div class="btn-bottom box">
					<button type="reset" class="btnlist-no box center" id="resetlist">重置</button>
					<a class="btnlist-yes box center" id="catechooseok">确认</a>
				</div>
			</form>
		</aside>
		
			
		<!--分类二级弹窗-->
		<aside class="ui-aside-second" id="catesecond" style="display: none;">
			<div class="changecate">已选分类：<span id="changesort"></span></div>
			<ul class="msg-list">
				<li>
					<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">全部分类</span></label>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">食品粮油</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">生鲜食品</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">休闲食品</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">粮油调味</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">方便食品</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">酒水饮料</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">中外酒类</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">冲饮茗茶</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">饮料乳品</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">个护清洁</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">口腔护理</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">洗发护发</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">身体清洁</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">清洁电器</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">清洁用品</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">医药保健</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">医疗保健</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">保健器械</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">家用厨电</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">家用厨具</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">家用餐具</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">厨房电器</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">医药保健</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">生活用品</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">家用电器</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">家纺用品</span></label>
					</div>
				</li>
				<li>
					<div class="muicontitle"><span class="sort-name">医药保健</span><i class="iconfont middle enter">&#xe613;</i></div>
					<div class="cate-box">
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">电子用品</span></label>
						<label class="mus-radio"><input type="radio" name="list"><i class="icon-radio"></i><span class="cateval">旅行用品</span></label>
					</div>
				</li>
			</ul>
			<a class="closesenond">取消</a>
		</aside>
		
			
		<!--品牌二级弹窗-->
		<aside class="ui-aside-second" id="brandsecond" style="display: none;">
			<div class="changecate">已选品牌：<span id="changebrand"></span><span id="seckeycounts"></span></div>
			<ul class="brandcontent brandcontainer">
				<li><label class="mus-check"><input type="checkbox" value="品客" name="list"><i class="icon-checks"></i><span class="cateval">品客</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="喜之郎" name="list"><i class="icon-checks"></i><span class="cateval">喜之郎</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="友臣" name="list"><i class="icon-checks"></i><span class="cateval">友臣</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="甘源" name="list"><i class="icon-checks"></i><span class="cateval">甘源</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="稻香村" name="list"><i class="icon-checks"></i><span class="cateval">稻香村</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="精益珍" name="list"><i class="icon-checks"></i><span class="cateval">精益珍</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="爱时乐(ASTICK)" name="list"><i class="icon-checks"></i><span class="cateval">爱时乐(ASTICK)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="瑞士莲(LINDT)" name="list"><i class="icon-checks"></i><span class="cateval">瑞士莲(LINDT)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="健达(KINDER)" name="list"><i class="icon-checks"></i><span class="cateval">健达(KINDER)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="瑞士莲(LINDT)" name="list"><i class="icon-checks"></i><span class="cateval">瑞士莲(LINDT)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="和情(LOTUS)" name="list"><i class="icon-checks"></i><span class="cateval">和情(LOTUS)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="神丹" name="list"><i class="icon-checks"></i><span class="cateval">神丹</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="爱时乐(ASTICK)" name="list"><i class="icon-checks"></i><span class="cateval">爱时乐(ASTICK)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="壹莲居" name="list"><i class="icon-checks"></i><span class="cateval">壹莲居</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="小老板(TAOKAENOI)" name="list"><i class="icon-checks"></i><span class="cateval">小老板(TAOKAENOI)</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="Z三N" name="list"><i class="icon-checks"></i><span class="cateval">Z三N</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="维达" name="list"><i class="icon-checks"></i><span class="cateval">维达</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="清风" name="list"><i class="icon-checks"></i><span class="cateval">清风</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="立白" name="list"><i class="icon-checks"></i><span class="cateval">立白</span></label></li>
				<li><label class="mus-check"><input type="checkbox" value="罗莱" name="list"><i class="icon-checks"></i><span class="cateval">罗莱</span></label></li>
			</ul>
			<div class="btn-bottom box">
				<a class="btnlist-no box center" id="catebrandno">清除</a>
				<a class="btnlist-yes box center" id="catebrandok">返回</a>
			</div>
		</aside>
		
		<!--推荐商品-->
		<div class="muilist-container proitem list" id="itemlist">
			<div class="mui-prolist clearfix" id="mui-prolist"></div>
		</div>
		
		<!--橱窗列表切换-->
		<div class="turnpro">
			<span id="tile" data-status="repeat">
				<i class="iconfont">&#xe634;</i>
			</span>
		</div>
		<!--悬浮购物车-->
		<div class="cartfixed">
			<div class="cartfixedbox">
				<span class="cartcount">0</span><a href="shopcart.html" class="listcart iconfont">&#xe625;</a>
			</div>
		</div>
		<!--返回顶部-->
	  	<a class="totop iconfont">&#xe60e;</a>
  	</div>
	<script type="text/javascript" src="static/js/jquery-3.1.1.min.js"></script>
	<script type="text/javascript" src="static/js/layer_mobile/layer.js"></script>
	<script type="text/javascript" src="static/js/common.js"></script>
	<script type="text/javascript" src="static/js/dropload.min.js" ></script>
	<script type="text/javascript" src="static/js/jquery.lazyload.min.js" ></script>
	<script>
		//列表页面搜索弹窗
		$("#searchinfo").on('click',function(){
			$("#searchlist").fadeIn()
			$("#idNumber").focus()
			ModalHelper.afterOpen();
		})
		$("#closesearch").on('click',function(){
			$("#searchlist").fadeOut()
			ModalHelper.beforeClose();
		})
		
		//模拟数据为空的情况
		function getParameter(param){  
	        var query = window.location.search;//获取URL地址中？后的所有字符  
	        var iLen = param.length;//获取你的参数名称长度  
	        var iStart = query.indexOf(param);//获取你该参数名称的真实索引  
	        if (iStart == -1)//-1为没有该参数  
	            return "";  
	        iStart += iLen + 1;  
	        var iEnd = query.indexOf("&", iStart);//获取第二个参数的其实索引  
	        if (iEnd == -1)//只有一个参数  
	            return query.substring(iStart);//获取单个参数的参数值  
	        return query.substring(iStart, iEnd);//获取第二个参数的值  
		}  
		  
		function link_jump(){
		    var param = getParameter("test");  
			
			if(param!=""){       //如果传递的值不等于空就执行
				document.getElementById("mui-prolist").remove();
				$("#listscreen").unbind('click');
				$(".dropload-down").remove();
				$("#itemlist").append('<div class="listempty"><i class="iconfont">&#xe611;</i><p>抱歉,没有找到哦!</p><p>请换个关键词试试吧!</p></div>')
				
			}
			
		} 
		//延时1S跳转，可自行修改延时时间
		setTimeout(link_jump, 500);
		
		$(function(){
			//排序菜单悬停
			var $header=$("#headTop").height();
			var $sorting=$('#list-sorting').height();
			$("#search_head").css('height',$header+$sorting);
			var scrollp=0;scrollt=0;
			$(window).on('scroll',function(){
				scrollp=document.scrollingElement.scrollTop || document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
				var scrollHeight = $(document).height(); 
				var windowHeight = $(this).height();
		        if($header<=scrollp){
		        	$("#search_head_fixer").css({
		            	'transform':'translate3d(0px, '+-$header+'px, 0px)',
		            	'transition':'transform 0.5s ease 0s'
		           	})  
		           	return false;
		        }else{           
		        	$("#search_head_fixer").css({
		            	'transform':'translate3d(0px, 0px, 0px)',
		            	'transition':'transform 0.5s ease 0s'
		            })
		        	return false;
		        }	
		
			})
			
			
		
		
			
			
			//主菜单显隐
			$('#mui-nav').click(function(event){
				var followButton = $(this);
				if (followButton.hasClass("following")){       
		            followButton.removeClass("following");       
		            $(".navbox").fadeOut();
		        }else{
		            followButton.addClass("following");  
		            $(".navbox").fadeIn();
		        }
		        event.stopPropagation();
			})
			$(document).click(function(){
		        $(".navbox").fadeOut();
		        $('#mui-nav').removeClass('following');
		    });
			
			//价格
			$('#list-ul .list-li .list-tab').each(function(index){
				$(this).click(function(event){
					$(this).addClass('selecton').parent().siblings().children().removeClass('selecton');
					if(index==1){
						var followButton = $(this);
						if (followButton.hasClass("following")){
							followButton.removeClass("following");       
							$(this).html('价格<img src="static/images/list_up.png">');
						}else{
							followButton.addClass("following");  
							$(this).html('价格<img src="static/images/list_down.png">');
						}
						event.stopPropagation();
						$(".navbox").fadeOut();
					}
					$('#mui-nav').removeClass('following');
				})
				$(".list-sorting").click(function(){
			        $("#listprice").html('价格<img src="static/images/list_default.png">');
			    });
			})			
		})
		
		$(function(){
			//筛选弹层
			$("#listscreen").click(function(){
				$('body').append('<div class="ui-aside-mask"></div>');
				$(".ui-aside-mask").animate({'opacity':'1'},300)
				$(".ui-aside").animate({'right':'0'},500)
				ModalHelper.afterOpen();
			})
			$("body").on('click','.ui-aside-mask',function(){
				$(".ui-aside").animate({'right':'-85%'},500)
				$(".ui-aside-mask").animate({'opacity':'0'},300)
				$(".ui-aside-mask").remove();
				ModalHelper.beforeClose();
				$("#listscreen").removeClass('selecton');
				$("#catesecond").fadeOut(100);
				$("#brandsecond").fadeOut(100);
				$("#placesecond").fadeOut(100);
			})
			
			
			//分类选择(分类二级弹窗开启)
			$("#option").click(function(){				
				$("#catesecond").fadeIn(100);
          	})
			
			//分类二级弹窗关闭
			$(".closesenond").click(function(){
				$("#catesecond").fadeOut(100);
			})
			
			
			//筛选弹层确认
			$("#catechooseok").click(function(){
				$(".ui-aside").animate({'right':'-85%'},500)
				$(".ui-aside-mask").animate({'opacity':'0'},300);
				$(".ui-aside-mask").remove();
				ModalHelper.beforeClose();
				$("#listscreen").removeClass('selecton');
					var $min_value=parseFloat($("#min_value").val().trim());
					var $max_value=parseFloat($("#max_value").val().trim());
					if($min_value>$max_value){
						$("#min_value").val($max_value);
						$("#max_value").val($min_value);
					}else{
						$("#min_value").val($min_value);
						$("#max_value").val($max_value);
					}
			})
			
			//分类
			$("#catesecond .mus-radio").each(function(index){
				$(this).change(function(){
					var $val = $(this).children('.cateval').text()
					var $sortval = $(this).parent().siblings().children(".sort-name").text()
					$("#catesecond").fadeOut(100);
					if($sortval==""){
						$("#keysort").text($sortval+$val);
						$("#changesort").text($sortval+$val);
					}else{
						$("#keysort").text($sortval+' / '+$val);
						$("#changesort").text($sortval+' / '+$val);
					}
				})
			})
			
			
			$(".msg-list li .muicontitle").click(function(){
				if($(this).siblings(".cate-box").is(":visible")){
					$(this).find("i").html("&#xe613;");
					$(this).siblings(".cate-box").slideUp(200).css('display','none');
				}else{
					$(this).find("i").html("&#xe739;");
					$(this).siblings(".cate-box").slideDown(200).css('display','block');
				}
			})

											
			//品牌
			$(".brandcontent input[type='checkbox']").on('change',function(){										
	        	var chk_value = [];			            
	            $(".brandcontent input[type='checkbox']:checked").each(function(){
	            	chk_value.push(this.value);
	            })			            
				var insuranceCasecodeVal = chk_value.length==0 ? '' : chk_value;
				$('#keybrand').text(chk_value.join("、"));
				$('#keycounts').text("等"+chk_value.length+"个");
				//console.log($("#keybrand").length)
				if($(".brandcontent input[type='checkbox']:checked")){
					if(chk_value.length<=1){
						$('#keycounts').hide();
					}else{
						$('#keycounts').show();
					}					
				}else{
					$('#keycounts').hide();
				}
				$("#changebrand").text(chk_value.join("、"));

				
			})
			var $uiaside = $(".ui-aside").width();
			var $brandWidth = $(".brandWidth").width();
			$("#keybrandbox").css({'width':$uiaside-$brandWidth});
			
			//查看全部品牌
			$("#lookall").click(function(){
				$("#brandsecond").fadeIn(100);
			})
			
			//品牌清除
			$("#catebrandno").click(function(){
				$("#changebrand").text("");
				$("#keybrand").text("");
				$("#keycounts").text("");
				$(".brandcontainer input[type='checkbox']:checked").each(function(){
					$(this).attr("checked",false);
					$("#changebrand").text("");
					$("#keybrand").text("");
					$("#keycounts").text("");
				})
				$(".brandbox input[type='checkbox']:checked").each(function(){
					$(this).attr("checked",false);	
				})
			})

			//品牌返回
			$("#catebrandok").click(function(){
				$("#brandsecond").fadeOut(100);
			})
			
			
		})
		
		function resetlist(){
			$('#resetlist').click(function(){
				$("#keybrand,#keycounts").empty()
				$("#keyplace,#placekeycounts").empty()
				$("#changesort,#keysort").empty()
				$("#catesecond input[type='radio']:checked").each(function(){
					$(this).attr("checked",false);
				})
				$(".brandcontainer input[type='checkbox']:checked").each(function(){
					$(this).attr("checked",false);
				})
				$(".brandbox input[type='checkbox']:checked").each(function(){
					$(this).attr("checked",false);	
				})
			})
		}
		resetlist()
		
		$(function(){
			$('#tile').on('click',function(){
				var status = $(this).attr("data-status");
				if(status=="repeat"){
					$(this).attr("data-status","list");
					$(this).html('<i class="iconfont">&#xe635;</i>');
					$('#itemlist').removeClass("list").addClass("repeat");
					$(".mui-item-li .mui-item-pic img").css('height', $(".mui-item-li .mui-item-pic .item_pic").width());
				}else if(status=="list"){
					$(this).attr("data-status","repeat");
					$(this).html('<i class="iconfont">&#xe634;</i>');
					$('#itemlist').removeClass("repeat").addClass('list');
					$(".mui-item-li .mui-item-pic img").css('height', $(".mui-item-li .mui-item-pic .item_pic").width());
				};
			});
		})
		
		
/**
 * JS实现未知图片大小的等比例缩放
 */

 function AutoImg(options) {
    
    this.config = {
        autoImg     : '.item-pic',     // 未知图片dom节点
        parentCls   : '.mui-item-pic'    // 父节点
    };

    this.cache = {
        
    };

    this.init(options);
 }
 
 AutoImg.prototype = {
    
     init: function(options){
        this.config = $.extend(this.config, options || {});
        var self = this,
            _config = self.config;
        
        $(_config.autoImg).each(function(index,img){
            
            var src = img.src,
                parentNode = $(img).closest(_config.parentCls),
                parentWidth = $(parentNode).width();
                
            // 先隐藏原图
            img.style.display = 'none';
            img.removeAttribute('src');

            

            // 获取图片头尺寸数据后立即调整图片
            imgReady(src, function (width,height) {

                // 等比例缩小
                if (width > parentWidth) {
                    height = parentWidth / width * height,
                    width = parentWidth;
                    img.style.width = width + 'px';
                    img.style.height = height + 'px';
                };
                // 显示原图
                img.style.display = '';
                
                img.setAttribute('src', src);
                
            });
        });
     }
 };

 var imgReady = (function(){
    var list = [],
        intervalId = null;

    // 用来执行队列
    var queue = function(){

        for(var i = 0; i < list.length; i++){
            list[i].end ? list.splice(i--,1) : list[i]();
        }
        !list.length && stop();
    };
    
    // 停止所有定时器队列
    var stop = function(){
        clearInterval(intervalId);
        intervalId = null;
    }
    return function(url, ready, error) {
        var onready = {}, 
            width, 
            height, 
            newWidth, 
            newHeight,
            img = new Image();
        img.src = url;

        // 如果图片被缓存，则直接返回缓存数据
        if(img.complete) {
            ready(img.width, img.height);
            return;
        }
        width = img.width;
        height = img.height;

        // 加载错误后的事件 
        img.onerror = function () {
            error && error.call(img);
            onready.end = true;
            img = img.onload = img.onerror = null;
        };

        // 图片尺寸就绪
        var onready = function() {
            newWidth = img.width;
            newHeight = img.height;
            if (newWidth !== width || newHeight !== height ||
                // 如果图片已经在其他地方加载可使用面积检测
                newWidth * newHeight > 1024
            ) {
                ready(img.width, img.height);
                onready.end = true;
            };
        };
        onready();
        // 完全加载完毕的事件
        img.onload = function () {
            // onload在定时器时间差范围内可能比onready快
            // 这里进行检查并保证onready优先执行
            !onready.end && onready();
            // IE gif动画会循环执行onload，置空onload即可
            img = img.onload = img.onerror = null;
        };
        
        
        // 加入队列中定期执行
        if (!onready.end) {
            list.push(onready);
            // 无论何时只允许出现一个定时器，减少浏览器性能损耗
            if (intervalId === null) {
                intervalId = setInterval(queue, 40);
            };
        };
    }
})();

	
		
		$(function(){
					
			//数据展示
		    var counter = 0;
		    // 每页展示10个
		    var num = 10;
		    var pageStart = 0,pageEnd = 0;
		 
		    // dropload
		    $('#itemlist').dropload({
		        scrollArea : window,
		        domDown : {
		            domClass   : 'dropload-down',
		            domRefresh : '<div class="dropload-refresh">↑上拉加载更多</div>',
		            domLoad    : '<div class="dropload-load"><span class="loading"></span>加载中...</div>',
		            domNoData  : '<div class="dropload-noData"><div class="center"><img class="emptyimg" src="static/images/bottom.png" /></div></div>'
		        },
		        threshold:"50",
		        loadDownFn : function(me){
		            $.ajax({
		                type: 'GET',
		                url: 'static/json/list.json',
		                dataType: 'json',
		                async: false,
		                success: function(data){
		                    var result = '';
		                    counter++;
		                    pageEnd = num * counter;
		                    pageStart = pageEnd - num;
		 
		                    for(var i = pageStart; i < pageEnd; i++){
		                    	if(i==0){
		                    		result +=   '<div class="mui-item-li opacity">'
												+'<a class="mui-item-pic">'
													+'<img class="lazy item-pic" src="'+data[i].src+'" title="" alt=""/>'
													+'<aside class="stock-desc">补货中</aside>'
												+'</a>'
												+'<div class="itemcontent">'
													+'<a class="mui-proname">'+data[i].name+'</a>'
													+'<div class="mui-flex">'
														+'<div class="mui-integration">&yen;'+data[i].price+'</div>'
														+'<div class="mui-action"><a style="color:#666;" class="iconfont mui-cart">&#xe624;</a></div>'
													+'</div>'
												+'</div>'
											+'</div>';
		                    	}else{
		                    		result +=   '<div class="mui-item-li opacity">'
												+'<a class="mui-item-pic" href="'+data[i].link+'">'
													+'<img class="lazy item-pic" src="'+data[i].src+'" title="" alt=""/>'
													+'<aside class="stock-desc">仅剩'+[i]+'件</aside>'
												+'</a>'
												+'<div class="itemcontent">'
													+'<a class="mui-proname" href="'+data[i].link+'">'+data[i].name+'</a>'
													+'<div class="mui-flex">'
														+'<div class="mui-integration">&yen;'+data[i].price+'</div>'
														+'<div class="mui-action"><a class="iconfont mui-cart addcart" href="javascript:addcart()">&#xe624;</a></div>'
													+'</div>'
												+'</div>'
											+'</div>';
		                    	}
		                        
		                        if((i + 1) >= data.length){
		                            // 锁定
		                            me.lock();
		                            // 无数据
		                            me.noData();
		                            break;
		                        }
		                    }
		                    // 为了测试，延迟1秒加载
		                    setTimeout(function(){
		                        $('#mui-prolist').append(result);
		                       
		                        // 每次数据加载完，必须重置
		                        $("img.lazy").lazyload({
								  	placeholder : "images/loading.gif", //用图片提前占位
								  	effect: "fadeIn", // 载入使用何种效果
								  	threshold: 200, // 提前开始加载,值为数字,代表页面高度,表示滚动条在离目标位置还有200的高度时就开始加载图片
								  	event: 'click',  // 事件触发时才加载,event,值有click(点击),mouseover(鼠标划过),sporty(运动的),foobar(…).可以实现鼠标莫过或点击图片才开始加载,后两个值未测试…
								  	container: $("#mui-prolist"),  // 对某容器中的图片实现效果,值为某容器.lazyload默认在拉动浏览器滚动条时生效,这个参数可以让你在拉动某DIV的滚动条时依次加载其中的图片
								  	failurelimit : 10 // 图片排序混乱时								    
								}).removeClass("lazy");
		                        me.resetload();
		                    },800);
		                    
		                },
		                error: function(xhr, type){
		                   	//debugger;
		                    layer.open({
		                    	content:"系统出错，请稍后再试！",
		            			btn: '我知道了'
		                    });
		                    // 即使加载出错，也得重置
		                    me.resetload();
		            	}
		        	});
		    	}
			});
		})
		
		function addcart(){
			layer.open({
            	content: '<i class="iconfont" style="vertical-align: middle;margin-right:5px;">&#xe637;</i><span style="vertical-align: middle;">加入购物车成功</span>',
            	style:'font-size:0.28rem;',
            	skin: 'msg',
            	time: 2 //2秒后自动关闭
            });
		}
		
	</script>
	<script>
		$(window).on('load', function () {
			$(".mui-item-li .mui-item-pic img").each(function(){
				$(this).css('height', $(".mui-item-li .mui-item-pic .item_pic").width());
			})
		    
		
		})
		$(window).on('scroll', function () {
		    $(".mui-item-li .mui-item-pic img").each(function(){
				$(this).css('height', $(".mui-item-li .mui-item-pic .item_pic").width());
				console.log($(this).index())
			})
		
		})
		$(window).on('resize', function () {
		    $(".mui-item-li .mui-item-pic img").each(function(){
				$(this).css('height', $(".mui-item-li .mui-item-pic .item_pic").width());
			})
		
		})
	</script>
</body>
</html>